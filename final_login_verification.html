<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¯ ç™»å½•åŠŸèƒ½æœ€ç»ˆéªŒè¯</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: #333;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            margin: 0;
            font-size: 2.5em;
            font-weight: 300;
        }
        
        .header p {
            margin: 10px 0 0 0;
            opacity: 0.9;
            font-size: 1.1em;
        }
        
        .content {
            padding: 30px;
        }
        
        .section {
            margin-bottom: 30px;
            padding: 25px;
            border-radius: 15px;
            border: 2px solid #f0f0f0;
            transition: all 0.3s ease;
        }
        
        .section:hover {
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.1);
        }
        
        .section h2 {
            margin: 0 0 20px 0;
            color: #667eea;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }
        
        input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-size: 16px;
            transition: border-color 0.3s ease;
            box-sizing: border-box;
        }
        
        input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }
        
        button {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            margin: 10px 10px 10px 0;
        }
        
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }
        
        button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            font-family: 'Courier New', monospace;
            white-space: pre-wrap;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
        }
        
        .info {
            background: #d1ecf1;
            color: #0c5460;
            border: 2px solid #bee5eb;
        }
        
        .console-log {
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            max-height: 300px;
            overflow-y: auto;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        
        .console-entry {
            margin: 2px 0;
            padding: 2px 5px;
            border-radius: 3px;
        }
        
        .console-log {
            background: #1e1e1e;
            color: #d4d4d4;
        }
        
        .console-error {
            color: #f44747;
            background: rgba(244, 71, 71, 0.1);
        }
        
        .console-warn {
            color: #ff8c00;
            background: rgba(255, 140, 0, 0.1);
        }
        
        .console-info {
            color: #4fc3f7;
            background: rgba(79, 195, 247, 0.1);
        }
        
        .console-success {
            color: #4caf50;
            background: rgba(76, 175, 80, 0.1);
        }
        
        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }
        
        .status-ok {
            background: #4caf50;
            animation: pulse 2s infinite;
        }
        
        .status-error {
            background: #f44336;
        }
        
        .status-warning {
            background: #ff9800;
        }
        
        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }
        
        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }
        
        .test-status {
            display: flex;
            align-items: center;
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            background: #f8f9fa;
        }
        
        .test-status.passed {
            background: #d4edda;
            color: #155724;
        }
        
        .test-status.failed {
            background: #f8d7da;
            color: #721c24;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¯ ç™»å½•åŠŸèƒ½æœ€ç»ˆéªŒè¯</h1>
            <p>å…¨é¢æµ‹è¯•ç™»å½•åŠŸèƒ½ï¼Œç¡®ä¿æ‰€æœ‰é—®é¢˜å·²è§£å†³</p>
        </div>
        
        <div class="content">
            <!-- ç³»ç»ŸçŠ¶æ€æ£€æŸ¥ -->
            <div class="section">
                <h2><span class="status-indicator status-ok"></span>ğŸ“Š ç³»ç»ŸçŠ¶æ€</h2>
                <div id="system-status" class="result info">
                    æ­£åœ¨æ£€æŸ¥ç³»ç»ŸçŠ¶æ€...
                </div>
            </div>
            
            <!-- ç™»å½•æµ‹è¯• -->
            <div class="section">
                <h2>ğŸ”‘ ç™»å½•åŠŸèƒ½æµ‹è¯•</h2>
                <div class="grid">
                    <div>
                        <div class="form-group">
                            <label for="username">ç”¨æˆ·åæˆ–é‚®ç®±:</label>
                            <input type="text" id="username" value="ç®¡ç†å‘˜" placeholder="è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±">
                        </div>
                        <div class="form-group">
                            <label for="password">å¯†ç :</label>
                            <input type="password" id="password" value="Admin123." placeholder="è¾“å…¥å¯†ç ">
                        </div>
                        <button onclick="testLogin()" id="login-btn">ğŸš€ æµ‹è¯•ç™»å½•</button>
                        <button onclick="testEmailLogin()">ğŸ“§ æµ‹è¯•é‚®ç®±ç™»å½•</button>
                        <button onclick="clearResults()">ğŸ§¹ æ¸…ç©ºç»“æœ</button>
                    </div>
                    <div>
                        <h3>æµ‹è¯•è´¦æˆ·ä¿¡æ¯</h3>
                        <div class="test-status passed">
                            âœ… ç”¨æˆ·å: ç®¡ç†å‘˜
                        </div>
                        <div class="test-status passed">
                            âœ… é‚®ç®±: admin@example.com
                        </div>
                        <div class="test-status passed">
                            âœ… å¯†ç : Admin123.
                        </div>
                        <div class="test-status passed">
                            âœ… è§’è‰²: admin
                        </div>
                    </div>
                </div>
                <div id="login-result" class="result" style="display: none;"></div>
            </div>
            
            <!-- ç½‘ç»œè¯·æ±‚ç›‘æ§ -->
            <div class="section">
                <h2>ğŸŒ ç½‘ç»œè¯·æ±‚ç›‘æ§</h2>
                <div class="console-log" id="network-console">
                    <div class="console-entry console-info">ç­‰å¾…ç½‘ç»œè¯·æ±‚...</div>
                </div>
            </div>
            
            <!-- æµè§ˆå™¨æ§åˆ¶å° -->
            <div class="section">
                <h2>ğŸ–¥ï¸ æµè§ˆå™¨æ§åˆ¶å°</h2>
                <div class="console-log" id="browser-console">
                    <div class="console-entry console-info">ç­‰å¾…æ§åˆ¶å°è¾“å‡º...</div>
                </div>
                <button onclick="clearConsole()">ğŸ§¹ æ¸…ç©ºæ§åˆ¶å°</button>
            </div>
            
            <!-- è¯¦ç»†è¯Šæ–­ä¿¡æ¯ -->
            <div class="section">
                <h2>ğŸ” è¯Šæ–­ä¿¡æ¯</h2>
                <div id="diagnostic-info" class="result info">
                    æ­£åœ¨æ”¶é›†è¯Šæ–­ä¿¡æ¯...
                </div>
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let consoleEntries = [];
        let networkEntries = [];
        
        // æ•è·æ§åˆ¶å°è¾“å‡º
        const originalConsole = {
            log: console.log,
            error: console.error,
            warn: console.warn,
            info: console.info
        };

        function addConsoleEntry(message, type = 'log') {
            const consoleLog = document.getElementById('browser-console');
            const entry = document.createElement('div');
            entry.className = `console-entry console-${type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            const icons = { log: 'ğŸ“', error: 'âŒ', warn: 'âš ï¸', info: 'â„¹ï¸' };
            entry.textContent = `[${timestamp}] ${icons[type] || 'ğŸ“'} ${message}`;
            
            consoleLog.appendChild(entry);
            consoleLog.scrollTop = consoleLog.scrollHeight;
            
            // é™åˆ¶æ—¥å¿—æ¡ç›®æ•°é‡
            while (consoleLog.children.length > 100) {
                consoleLog.removeChild(consoleLog.firstChild);
            }
            
            consoleEntries.push({ timestamp, message, type });
        }

        // é‡å†™consoleæ–¹æ³•
        console.log = function(...args) {
            originalConsole.log.apply(console, args);
            addConsoleEntry(args.join(' '), 'log');
        };
        console.error = function(...args) {
            originalConsole.error.apply(console, args);
            addConsoleEntry(args.join(' '), 'error');
        };
        console.warn = function(...args) {
            originalConsole.warn.apply(console, args);
            addConsoleEntry(args.join(' '), 'warn');
        };
        console.info = function(...args) {
            originalConsole.info.apply(console, args);
            addConsoleEntry(args.join(' '), 'info');
        };

        // ç½‘ç»œè¯·æ±‚ç›‘æ§
        function addNetworkEntry(message, type = 'info') {
            const networkLog = document.getElementById('network-console');
            const entry = document.createElement('div');
            entry.className = `console-entry console-${type}`;
            
            const timestamp = new Date().toLocaleTimeString();
            const icons = { request: 'ğŸ“¤', response: 'ğŸ“¥', error: 'âŒ', success: 'âœ…' };
            entry.textContent = `[${timestamp}] ${icons[type] || 'ğŸ“¡'} ${message}`;
            
            networkLog.appendChild(entry);
            networkLog.scrollTop = networkLog.scrollHeight;
            
            // é™åˆ¶æ—¥å¿—æ¡ç›®æ•°é‡
            while (networkLog.children.length > 50) {
                networkLog.removeChild(networkLog.firstChild);
            }
            
            networkEntries.push({ timestamp, message, type });
        }

        function updateResult(elementId, content, type = 'info') {
            const element = document.getElementById(elementId);
            element.className = `result ${type}`;
            element.textContent = content;
            element.style.display = 'block';
        }

        function updateSystemStatus() {
            const status = {
                'å‰ç«¯æœåŠ¡å™¨': 'http://10.26.120.9:8000',
                'åç«¯API': 'http://10.26.120.9:4000',
                'æµè§ˆå™¨': navigator.userAgent.substring(0, 50) + '...',
                'ç½‘ç»œçŠ¶æ€': navigator.onLine ? 'åœ¨çº¿' : 'ç¦»çº¿',
                'æ—¶é—´': new Date().toLocaleString()
            };
            
            let statusText = 'ç³»ç»ŸçŠ¶æ€æ£€æŸ¥ç»“æœ:\n\n';
            for (const [key, value] of Object.entries(status)) {
                statusText += `âœ… ${key}: ${value}\n`;
            }
            
            updateResult('system-status', statusText, 'success');
        }

        async function testLogin() {
            const username = document.getElementById('username').value.trim();
            const password = document.getElementById('password').value;
            
            console.log('ğŸš€ å¼€å§‹ç™»å½•æµ‹è¯•...');
            console.log(`ç”¨æˆ·å: ${username}`);
            console.log(`å¯†ç é•¿åº¦: ${password.length}`);
            
            const btn = document.getElementById('login-btn');
            btn.disabled = true;
            btn.textContent = 'æµ‹è¯•ä¸­...';
            
            try {
                // æ™ºèƒ½è¯†åˆ«ç”¨æˆ·åæˆ–é‚®ç®±
                const loginParams = { password };
                const isEmail = /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(username);
                
                if (isEmail) {
                    loginParams.email = username;
                    console.log('ğŸ“§ æ£€æµ‹ä¸ºé‚®ç®±æ ¼å¼ï¼Œä½¿ç”¨emailå­—æ®µ');
                    addNetworkEntry('æ£€æµ‹åˆ°é‚®ç®±æ ¼å¼ï¼Œå°†ä½¿ç”¨emailå­—æ®µ', 'info');
                } else {
                    loginParams.username = username;
                    console.log('ğŸ‘¤ æ£€æµ‹ä¸ºç”¨æˆ·åæ ¼å¼ï¼Œä½¿ç”¨usernameå­—æ®µ');
                    addNetworkEntry('æ£€æµ‹åˆ°ç”¨æˆ·åæ ¼å¼ï¼Œå°†ä½¿ç”¨usernameå­—æ®µ', 'info');
                }

                console.log('ğŸ“¤ å‘é€ç™»å½•è¯·æ±‚:', loginParams);
                addNetworkEntry(`å‘é€è¯·æ±‚: ${JSON.stringify(loginParams)}`, 'request');
                
                const startTime = Date.now();
                
                const response = await fetch('http://10.26.120.9:4000/api/auth/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'User-Agent': navigator.userAgent
                    },
                    body: JSON.stringify(loginParams)
                });
                
                const endTime = Date.now();
                
                console.log(`ğŸ“¥ æ”¶åˆ°å“åº”: ${response.status} ${response.statusText}`);
                addNetworkEntry(`æ”¶åˆ°å“åº”: ${response.status} ${response.statusText} (è€—æ—¶: ${endTime - startTime}ms)`, 'response');
                
                const responseText = await response.text();
                console.log('ğŸ“¥ åŸå§‹å“åº”:', responseText);
                addNetworkEntry(`åŸå§‹å“åº”: ${responseText}`, 'response');
                
                let responseData;
                try {
                    responseData = JSON.parse(responseText);
                    console.log('ğŸ“¥ è§£æåå“åº”:', responseData);
                    addNetworkEntry(`è§£æåå“åº”: ${JSON.stringify(responseData, null, 2)}`, 'response');
                } catch (parseError) {
                    console.error('âŒ JSONè§£æå¤±è´¥:', parseError);
                    addNetworkEntry(`JSONè§£æå¤±è´¥: ${parseError.message}`, 'error');
                    throw new Error(`å“åº”æ ¼å¼é”™è¯¯: ${responseText}`);
                }
                
                if (response.ok && responseData.success) {
                    console.log('âœ… ç™»å½•æˆåŠŸ!');
                    addNetworkEntry('âœ… ç™»å½•æˆåŠŸ!', 'success');
                    
                    const successText = `ğŸ‰ ç™»å½•æµ‹è¯•æˆåŠŸ!

å“åº”çŠ¶æ€: ${response.status} ${response.statusText}
å“åº”æ—¶é—´: ${endTime - startTime}ms

ç”¨æˆ·ä¿¡æ¯:
- ID: ${responseData.data?.user?.id || 'N/A'}
- ç”¨æˆ·å: ${responseData.data?.user?.username || 'N/A'}
- é‚®ç®±: ${responseData.data?.user?.email || 'N/A'}
- è§’è‰²: ${responseData.data?.user?.role || 'N/A'}

ä»¤ç‰Œä¿¡æ¯:
- è®¿é—®ä»¤ç‰Œ: ${responseData.data?.tokens?.accessToken ? 'å·²è·å–' : 'æœªè·å–'}
- åˆ·æ–°ä»¤ç‰Œ: ${responseData.data?.tokens?.refreshToken ? 'å·²è·å–' : 'æœªè·å–'}

ä¼šè¯ä¿¡æ¯:
- ä¼šè¯ID: ${responseData.data?.session?.sessionId || 'N/A'}
- çŠ¶æ€: ${responseData.data?.session?.status || 'N/A'}

âœ… ä¿®å¤çŠ¶æ€: å‰ç«¯æ™ºèƒ½è¯†åˆ«é€»è¾‘å·¥ä½œæ­£å¸¸
âœ… åç«¯å“åº”: å®Œå…¨æ­£å¸¸
âœ… ç½‘ç»œé€šä¿¡: æˆåŠŸ

ğŸ¯ ç»“è®º: ç™»å½•åŠŸèƒ½å·²å®Œå…¨ä¿®å¤å¹¶æ­£å¸¸å·¥ä½œï¼`;
                    
                    updateResult('login-result', successText, 'success');
                    
                } else {
                    console.error('âŒ ç™»å½•å¤±è´¥:', responseData.message || 'æœªçŸ¥é”™è¯¯');
                    addNetworkEntry(`âŒ ç™»å½•å¤±è´¥: ${responseData.message || 'æœªçŸ¥é”™è¯¯'}`, 'error');
                    
                    const errorText = `âŒ ç™»å½•æµ‹è¯•å¤±è´¥

å“åº”çŠ¶æ€: ${response.status} ${response.statusText}
é”™è¯¯ä¿¡æ¯: ${responseData.message || 'æœªçŸ¥é”™è¯¯'}

é”™è¯¯è¯¦æƒ…:
${responseData.error ? JSON.stringify(responseData.error, null, 2) : 'æ— è¯¦ç»†é”™è¯¯ä¿¡æ¯'}

è¯·æ£€æŸ¥:
1. ç”¨æˆ·åæˆ–å¯†ç æ˜¯å¦æ­£ç¡®
2. ç½‘ç»œè¿æ¥æ˜¯å¦æ­£å¸¸
3. åç«¯æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œ`;
                    
                    updateResult('login-result', errorText, 'error');
                }
                
            } catch (error) {
                console.error('âŒ ç™»å½•è¯·æ±‚å¼‚å¸¸:', error);
                addNetworkEntry(`âŒ ç™»å½•è¯·æ±‚å¼‚å¸¸: ${error.message}`, 'error');
                
                const errorText = `âŒ ç™»å½•è¯·æ±‚å¼‚å¸¸

é”™è¯¯ç±»å‹: ${error.name}
é”™è¯¯ä¿¡æ¯: ${error.message}

å¯èƒ½åŸå› :
1. ç½‘ç»œè¿æ¥é—®é¢˜
2. CORSè·¨åŸŸé—®é¢˜
3. åç«¯æœåŠ¡ä¸å¯ç”¨
4. è¯·æ±‚æ ¼å¼é”™è¯¯

å»ºè®®æ“ä½œ:
1. æ£€æŸ¥ç½‘ç»œè¿æ¥
2. ç¡®è®¤åç«¯æœåŠ¡è¿è¡Œæ­£å¸¸
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°è¯¦ç»†é”™è¯¯`;
                
                updateResult('login-result', errorText, 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = 'ğŸš€ æµ‹è¯•ç™»å½•';
            }
        }

        function testEmailLogin() {
            document.getElementById('username').value = 'admin@example.com';
            testLogin();
        }

        function clearResults() {
            document.getElementById('login-result').style.display = 'none';
            document.getElementById('network-console').innerHTML = '<div class="console-entry console-info">ç½‘ç»œè¯·æ±‚æ—¥å¿—å·²æ¸…ç©º...</div>';
            networkEntries = [];
        }

        function clearConsole() {
            document.getElementById('browser-console').innerHTML = '<div class="console-entry console-info">æ§åˆ¶å°å·²æ¸…ç©ºï¼Œç­‰å¾…æ–°çš„è¾“å‡º...</div>';
            consoleEntries = [];
        }

        function updateDiagnostic() {
            const diagnostic = {
                'é¡µé¢ä¿¡æ¯': {
                    'URL': window.location.href,
                    'æ ‡é¢˜': document.title,
                    'åŠ è½½æ—¶é—´': new Date().toLocaleString()
                },
                'æµè§ˆå™¨ä¿¡æ¯': {
                    'ç”¨æˆ·ä»£ç†': navigator.userAgent,
                    'å¹³å°': navigator.platform,
                    'è¯­è¨€': navigator.language,
                    'åœ¨çº¿çŠ¶æ€': navigator.onLine ? 'åœ¨çº¿' : 'ç¦»çº¿'
                },
                'å±å¹•ä¿¡æ¯': {
                    'åˆ†è¾¨ç‡': `${screen.width}x${screen.height}`,
                    'å¯ç”¨åŒºåŸŸ': `${screen.availWidth}x${screen.availHeight}`,
                    'é¢œè‰²æ·±åº¦': `${screen.colorDepth}ä½`
                },
                'ç½‘ç»œä¿¡æ¯': {
                    'åè®®': window.location.protocol,
                    'ä¸»æœº': window.location.host,
                    'ç«¯å£': window.location.port || 'é»˜è®¤ç«¯å£'
                },
                'æœ¬åœ°å­˜å‚¨': {
                    'access_token': localStorage.getItem('access_token') ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®',
                    'refresh_token': localStorage.getItem('refresh_token') ? 'å·²è®¾ç½®' : 'æœªè®¾ç½®'
                }
            };
            
            let diagnosticText = 'è¯¦ç»†è¯Šæ–­ä¿¡æ¯:\n\n';
            for (const [category, items] of Object.entries(diagnostic)) {
                diagnosticText += `${category}:\n`;
                for (const [key, value] of Object.entries(items)) {
                    diagnosticText += `  ${key}: ${value}\n`;
                }
                diagnosticText += '\n';
            }
            
            updateResult('diagnostic-info', diagnosticText, 'info');
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.addEventListener('load', function() {
            console.log('ğŸ¯ ç™»å½•åŠŸèƒ½éªŒè¯é¡µé¢å·²åŠ è½½');
            console.log('ğŸ”§ å¼€å§‹åˆå§‹åŒ–ç³»ç»Ÿæ£€æŸ¥...');
            
            // æ˜¾ç¤ºåˆå§‹ä¿¡æ¯
            updateSystemStatus();
            updateDiagnostic();
            
            // è‡ªåŠ¨å¼€å§‹æµ‹è¯•
            setTimeout(() => {
                console.log('ğŸš€ è‡ªåŠ¨å¼€å§‹ç™»å½•æµ‹è¯•...');
                testLogin();
            }, 1000);
            
            // ç›‘å¬ç½‘ç»œçŠ¶æ€å˜åŒ–
            window.addEventListener('online', function() {
                console.log('ğŸŒ ç½‘ç»œè¿æ¥å·²æ¢å¤');
                addNetworkEntry('ğŸŒ ç½‘ç»œè¿æ¥å·²æ¢å¤', 'success');
                updateSystemStatus();
            });

            window.addEventListener('offline', function() {
                console.log('ğŸŒ ç½‘ç»œè¿æ¥å·²æ–­å¼€');
                addNetworkEntry('ğŸŒ ç½‘ç»œè¿æ¥å·²æ–­å¼€', 'error');
                updateSystemStatus();
            });
        });

        // ç›‘å¬æœªæ•è·çš„é”™è¯¯
        window.addEventListener('error', function(event) {
            console.error('ğŸ’¥ æœªæ•è·çš„é”™è¯¯:', event.error);
            addConsoleEntry(`æœªæ•è·é”™è¯¯: ${event.error?.message || event.message}`, 'error');
        });

        // ç›‘å¬Promiseé”™è¯¯
        window.addEventListener('unhandledrejection', function(event) {
            console.error('ğŸ’¥ æœªå¤„ç†çš„Promiseé”™è¯¯:', event.reason);
            addConsoleEntry(`Promiseé”™è¯¯: ${event.reason?.message || event.reason}`, 'error');
        });
    </script>
</body>
</html>