# 敏感信息安全检查指南和清单

## 1. 敏感信息类型识别清单

### 高风险敏感信息（必须立即处理）
- **API密钥和访问令牌**
  - AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY
  - Google API Keys, Facebook App Keys
  - 第三方服务API密钥（如Stripe、PayPal等）
  - 数据库连接字符串
  - Redis连接信息

- **认证凭证**
  - JWT Secret密钥
  - Session密钥
  - OAuth2客户端密钥
  - SMTP认证信息

- **数据库凭证**
  - MySQL/PostgreSQL用户名密码
  - 数据库连接URL
  - 管理员账号信息

### 中等风险敏感信息（需要处理）
- **个人信息**
  - 真实姓名、邮箱、手机号
  - 身份证号等个人信息
  - IP地址（服务器真实IP）

- **系统配置**
  - 服务器IP和端口
  - 内部服务地址
  - 第三方服务终端URL

### 低风险信息（酌情处理）
- **项目配置**
  - 开发环境标识
  - 测试环境配置
  - 公司内部项目名称

## 2. 文件类型检查优先级

### 第一优先级（立即检查）
1. **配置文件**
   - .env.*（除.env.example外）
   - config/*.js（数据库配置、API配置等）
   - package.json（scripts中的敏感信息）
   - webpack.config.js, vite.config.ts
   - docker-compose.yml

2. **源代码文件**
   - services/*.js（服务层文件）
   - controllers/*.js（控制器文件）
   - middleware/*.js（中间件文件）
   - utils/*.js（工具文件）

### 第二优先级（仔细检查）
3. **测试和文档文件**
   - test/*.js
   - docs/*.md
   - README.md
   - *.test.js, *.spec.js

4. **构建和部署文件**
   - Dockerfile
   - .github/workflows/*.yml
   - deployment scripts

### 第三优先级（选择性检查）
5. **日志和缓存文件**
   - logs/*.log
   - cache files
   - 临时文件

## 3. 搜索模式和正则表达式

### API密钥模式
```
/[A-Za-z0-9]{32,}/g  // 32位以上字母数字组合
/sk_[a-zA-Z0-9]{24,}/g  // Stripe密钥模式
/rk_live_[a-zA-Z0-9]{24,}/g  // Stripe实时密钥
```

### 数据库连接字符串模式
```
/mysql:\/\/[^\s]+/g
/postgresql:\/\/[^\s]+/g
/mongodb:\/\/[^\s]+/g
/redis:\/\/[^\s]+/g
```

### JWT密钥模式
```
/JWT_SECRET.*=/g
/jwt.*secret.*=/gi
/secret.*key.*=/gi
```

### 邮箱和敏感信息模式
```
/[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}/g
/password.*=.*['"][^'"]+['"]/gi
/api[_-]?key.*=.*['"][^'"]+['"]/gi
```

## 4. 处理方法

### 移除敏感信息
- 直接删除硬编码的敏感数据
- 使用环境变量替代
- 创建.env.example作为模板

### 加密处理
- 对必要的敏感配置进行加密
- 使用密钥管理系统

### 占位符替换
- 将真实密钥替换为格式正确的占位符
- 确保占位符格式与实际格式一致

## 5. 检查流程

1. **准备阶段**
   - 备份当前项目状态
   - 安装必要的安全检查工具

2. **全面扫描**
   - 使用grep搜索敏感信息模式
   - 逐个检查重要配置文件
   - 查看Git历史记录

3. **分类处理**
   - 按风险等级分类发现的问题
   - 选择合适的处理方法
   - 实施修改

4. **验证测试**
   - 确认功能不受影响
   - 测试关键业务流程
   - 验证环境变量配置

5. **文档记录**
   - 记录处理过程
   - 生成安全检查报告
   - 制定预防措施

## 6. 预防措施

### 代码审查流程
- 在代码审查中强制检查敏感信息
- 使用自动化工具进行预检查
- 建立敏感信息处理标准

### 自动化工具
- 集成敏感信息检测工具
- 设置CI/CD流程中的安全检查
- 定期执行安全扫描

### 团队培训
- 敏感信息安全意识培训
- 最佳实践文档化
- 定期安全知识更新

## 7. 检查完成标准

- [ ] 所有高风险敏感信息已处理
- [ ] 环境变量配置正确
- [ ] 功能测试通过
- [ ] 安全检查报告生成
- [ ] 预防措施文档化